# Agent Sudo
## Enumerate

**How many open ports?**

1. Use NMap to scan the server

Scan Types: Nmap supports various scan types. The most common ones are:

-   TCP SYN Scan (-sS): This is the default scan type and is often used for fast scans. It sends SYN packets to each port and listens for SYN-ACK responses.
-   TCP Connect Scan (-sT): This is a slower but more reliable scan type. It attempts to establish a full TCP connection with each port to determine if it's open.
-   UDP Scan (-sU): Used to scan for open UDP ports. UDP scanning is less reliable than TCP scanning because UDP is connectionless.
-   Aggressive Scan (-A): This enables OS detection, version detection, script scanning, and traceroute.
    
    1. nmap -sS 10.10.99.205
       1. Reveals 3 open ports
          1. 21/tcp ftp
          2. 22/tcp ssh
          3. 80/tcp http

**How do you redirect yourself to a secret page?**

1. Assume port 80 is a webserver. Walk the page
2. Visit web server and check for items, very simple webpage. 
   1. Use your own codename as user-agent to access the site. - This is what the site says to access the page. 
   2. Page states that this message is from Agent R
      1. At this point the hints point to manipulating the **User Agent** of the web request
         1. Capture the request in Burp
         2. Send to Intruder
         3. Set up an attack using Sniper that cycles through the alphabet. Run the attack 
         4. A 302 response is seen when the **C** character is used as the **User-Agent**
            1. Checking the response you see `agent_C_attention.php`
            2. Navigate to `agent_C_attention.php` to view the page. 

**What is the agent name**

After navigating to `agent_C_attention.php` you see the agents name is **chris**

## Hash Cracking and Brute Force

### What is the FTP password

1. Perform recon on FTP
   1. `nmap -sV -p 21 [FTP server IP]`
```root@ip-10-10-135-116:~# nmap -sV -p 21 10.10.12.81

Starting Nmap 7.60 ( https://nmap.org ) at 2024-05-15 22:05 BST
Nmap scan report for ip-10-10-12-81.eu-west-1.compute.internal (10.10.12.81)
Host is up (0.00033s latency).

PORT   STATE SERVICE VERSION
21/tcp open  ftp     vsftpd 3.0.3
MAC Address: 02:DD:A7:78:19:DB (Unknown)
Service Info: OS: Unix
```
2. Attempt brute force using hydra per the hint "Hail hydra"
      1. Run `hydra -l chris -P /usr/share/wordlists/rockyou.txt`
![alt text](image.png)

Password is `crystal`

### What is the zip password

Downloaded all files from the ftp share. None are obviously zip files. Attempted to unzip with the unzip command, none worked. At this point I googled the walkthrough and learned that 7zip will work. **TRY OTHER TOOLS!**

1. Ran `7z x cutie.png`
2. Password protected, CTF give hint Mr. John. Lets assume that means John the Ripper. 
   1. John the ripper comes with a tool called `zip2john`
3. Did not work. Learned about **binwalk** from the write up. - https://www.kali.org/tools/binwalk/
   1. Binwalk is a tool for searching a given binary image for embedded files and executable code. Specifically, it is designed for identifying files and code embedded inside of firmware images. Binwalk uses the libmagic library, so it is compatible with magic signatures created for the Unix file utility.
   2. Ran `binwalk cutie.png` See output below: