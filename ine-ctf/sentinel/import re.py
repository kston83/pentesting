import re

def parse_log_file(file_path):
    # Regex to capture event identifiers from the log content
    event_id_pattern = re.compile(r"Event identifier\s*:\s*0x[0-9a-fA-F]+\s*\((\d+)\)")
    
    # Set to store unique event identifiers
    unique_identifiers = set()

    # Read the log file
    with open(file_path, 'r') as file:
        for line in file:
            # Search for event identifiers in each line
            match = event_id_pattern.search(line)
            if match:
                # Add the numeric part of the event identifier to the set
                unique_identifiers.add(match.group(1))

    return unique_identifiers

def write_unique_identifiers(identifiers, output_file_path):
    # Write unique identifiers to a file
    with open(output_file_path, 'w') as file:
        for identifier in sorted(identifiers, key=int):
            file.write(f"{identifier}\n")

# Example usage
log_file_path = 'security.log'
output_file_path = 'unique_event_identifiers.txt'

# Parse the log file
unique_ids = parse_log_file(log_file_path)

# Write the unique event identifiers to a file
write_unique_identifiers(unique_ids, output_file_path)

print(f"Unique event identifiers have been extracted and saved to {output_file_path}.")
