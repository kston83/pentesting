import re

def parse_log_file(file_path):
    # Regex to capture computer names from the log content
    computer_name_pattern = re.compile(r"Computer name\s*:\s*(\S+)")
    
    # Set to store unique computer names
    unique_computer_names = set()

    # Read the log file
    with open(file_path, 'r') as file:
        for line in file:
            # Search for computer names in each line
            match = computer_name_pattern.search(line)
            if match:
                # Add the computer name to the set
                unique_computer_names.add(match.group(1))

    return unique_computer_names

def write_unique_computer_names(names, output_file_path):
    # Write unique computer names to a file
    with open(output_file_path, 'w') as file:
        for name in sorted(names):
            file.write(f"{name}\n")

# Example usage
log_file_path = 'security.log'
output_file_path = 'unique_computer_names.txt'

# Parse the log file
unique_names = parse_log_file(log_file_path)

# Write the unique computer names to a file
write_unique_computer_names(unique_names, output_file_path)

print(f"Unique computer names have been extracted and saved to {output_file_path}.")
